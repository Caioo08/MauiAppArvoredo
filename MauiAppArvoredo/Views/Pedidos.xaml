<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiAppArvoredo.Views.Pedidos"
             Title="Pedidos"
             BackgroundColor="White"
             Shell.NavBarIsVisible="False">
    <ContentPage.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#fae6c2" Offset="0.1"/>
            <GradientStop Color="#c68f56" Offset="0.4"/>
            <GradientStop Color="#b47b39" Offset="0.7"/>
        </LinearGradientBrush>
    </ContentPage.Background>

    <Grid Padding="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- BotÃ£o Voltar -->
        <Button Grid.Row="0"
                x:Name="btnSair" 
                Text="â† Voltar" 
                BackgroundColor="#391b01" 
                Clicked="BtnSair_Clicked"
                TextColor="White" 
                FontSize="18" 
                FontAttributes="Bold"
                CornerRadius="10"
                WidthRequest="150" 
                HorizontalOptions="Start" 
                Margin="0,0,0,10" />

        <!-- TÃ­tulo -->
        <Label Grid.Row="1"
               Text="ðŸ“‹ PEDIDOS / ORÃ‡AMENTOS"
               FontSize="24"
               FontAttributes="Bold"
               TextColor="#391b01"
               HorizontalOptions="Center"
               Margin="0,0,0,15"/>

        <!-- Lista de Pedidos -->
        <ScrollView Grid.Row="2">
            <CollectionView x:Name="ListaPedidos" 
                          SelectionMode="None">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame BackgroundColor="#efd4ac" 
                               CornerRadius="15" 
                               Margin="0,8" 
                               Padding="15"
                               HasShadow="True">
                            <VerticalStackLayout Spacing="10">

                                <!-- CabeÃ§alho com Cliente -->
                                <Grid ColumnDefinitions="*,Auto">
                                    <Label Grid.Column="0"
                                           Text="{Binding Cliente}" 
                                           FontAttributes="Bold" 
                                           FontSize="18"
                                           TextColor="#391b01"/>

                                    <Label Grid.Column="1"
                                           Text="{Binding Status}"
                                           FontSize="12"
                                           FontAttributes="Bold"
                                           TextColor="Green"
                                           VerticalOptions="Center"
                                           Padding="8,4"
                                           BackgroundColor="White"/>
                                </Grid>

                                <!-- DescriÃ§Ã£o -->
                                <Label Text="{Binding Descricao}" 
                                       TextColor="#391b01"
                                       FontSize="14"/>

                                <!-- Valor Total -->
                                <Label TextColor="#391b01"
                                       FontSize="16"
                                       FontAttributes="Bold">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span Text="ðŸ’° Valor: R$ "/>
                                            <Span Text="{Binding ValorTotal, StringFormat='{0:F2}'}"/>
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>

                                <!-- Data -->
                                <Label Text="{Binding DataCriacao, StringFormat='ðŸ“… {0:dd/MM/yyyy HH:mm}'}"
                                       TextColor="#666"
                                       FontSize="12"/>

                                <!-- Separador -->
                                <BoxView HeightRequest="1"
                                         BackgroundColor="#391b01"
                                         Opacity="0.3"
                                         Margin="0,5"/>

                                <!-- BotÃµes -->
                                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                                    <Button Grid.Column="0"
                                            Text="âœ“ Dar Baixa" 
                                            Clicked="BtnDarBaixa_Clicked"
                                            BackgroundColor="#4CAF50" 
                                            TextColor="White"
                                            CornerRadius="10"
                                            HeightRequest="45"/>

                                    <Button Grid.Column="1"
                                            Text="ðŸ“„ Detalhes" 
                                            Clicked="BtnDetalhes_Clicked"
                                            BackgroundColor="#391b01" 
                                            TextColor="White"
                                            CornerRadius="10"
                                            HeightRequest="45"/>
                                </Grid>

                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>

                <!-- Mensagem quando vazio -->
                <CollectionView.EmptyView>
                    <VerticalStackLayout HorizontalOptions="Center" 
                                       VerticalOptions="Center"
                                       Spacing="15"
                                       Margin="0,50,0,0">
                        <Label Text="ðŸ“­"
                               FontSize="60"
                               HorizontalOptions="Center"/>
                        <Label Text="Nenhum pedido encontrado"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#391b01"
                               HorizontalOptions="Center"/>
                        <Label Text="Os pedidos da API aparecerÃ£o aqui"
                               FontSize="14"
                               TextColor="#666"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </CollectionView.EmptyView>
            </CollectionView>
        </ScrollView>

    </Grid>
</ContentPage>